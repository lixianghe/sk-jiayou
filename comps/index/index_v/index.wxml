<wxs module="m2">
  var formatVal = function (val) {
		// 判断参数是数组，instanceof 不可用 暂时先这么判断
    return typeof val === 'object' ? val : [val]
  }
	var formatNum = function (val, num) {
		return val.substring(0, num)
	}
  module.exports = {
		formatVal: formatVal, 
		formatNum: formatNum
	};
</wxs>
<!-- 页面容器 -->
<view class="page {{colorStyle}}" wx:if="{{videoList.length>0}}" style="background:{{backgroundColor}}">
  <view class="card-nav">
    <view class="location">
        <image class="locationPic loading" src="{{locationPic}}" wx:if="{{isLoading}}"></image>
        <image class="locationPic" src="{{locationPic}}" wx:else></image>
        <text class="address" bindtap="loadLocation">{{address}}</text>
      <view class="oil" bindtap="showOil">
        <text>92#</text>
        <image src="../../../images/dark/icon.png"></image>
      </view>
      <view class="brand" bindtap="showBrand">
        <text>全部品牌</text>
        <image src="../../../images/dark/icon.png"></image>
      </view>
    </view>
    <view></view>
    <view class="price">
      <text>今日指导价</text>
      <swiper current="{{swiperCurrent}}" interval = '3000' autoplay = 'true' circular="true" vertical="true" class="swiper">
       <block data-item="{{item}}" wx:for="{{swiperArr}}" wx:key="id">
       <swiper-item  class="swiper-item">
         {{item.oil}}
         <text class="num">￥{{item.num}}</text>
       </swiper-item>
       </block>
      </swiper>
    </view>

    


  </view>
  <!-- 页面盒子 -->
  <scroll-view class="scroll-view-bar" scroll-x="true" bindscrolltolower="scrollRight">
    <view class="pick-card" wx:for="{{videoList}}" wx:for-item="item" wx:for-index="idx" wx:key="id" catchtap="navDetail" data-itemId="{{item.id}}">
      <!-- 竖图信息最多态 -->
      <view class="vpick-item" bindtap="linkInfo">
        <view class="vpick-titL">
          <view class="pick-title">{{item.mainTitle}}</view>
          <view class="vindex-tag">
            <image src="../../../images/dark/invalid_name.png" class="invalidName"></image>
            <text class="vindexTagmain">{{item.mainLabel}}</text>
            <text class="cancleText">5.09</text>
          </view>
          <view class="tag-group">
            <text class="vpick-tag" wx:for="{{item.subLabel.length > 2 ? 2: item.subLabel.length}}" wx:for-item="cell" wx:key="index">{{item.subLabel[cell]}}</text>
          </view>
        </view>
        <view class="vpick-img {{!item.subTitle ? 'vpick-cardBig' : ''}}">
          <image wx:if="{{item.image}}" class="pick-cover" src="{{item.image}}" binderror="imgLoadErr" data-index="{{idx}}"></image>
        </view>
        <view class="pick-subTitle">
          <view class="pick-address" wx:for="{{ m2.formatVal(item.subTitle) }}" wx:for-item="curr" wx:key="index">
            {{ curr }}
          </view>
          <view class="navToMap" catchtap="navToMap" data-lat="{{item.lat}}" data-lng="{{item.lng}}" data-address="{{item.address}}">
            <image class="vpick-navTo" src="{{button[0].icon}}" catchtap="navToMap"></image>
            <text style="vertical-align: text-bottom;">5.5km</text>
          </view>
        </view>
      </view>
    </view>
  </scroll-view>


  <Nodata code="{{retcode}}" bindrefresh="reloadData"></Nodata>
</view>



<!-- 油号的弹框 -->
<view class="oilCard" animation="{{oilAnimation}}">
  
  <image bindtap="closeOil" src="../../../images/dark/closeList.png" />
  <view class="cardContent">
    <text class="oilTitle">汽油</text>
    <view class="oiltypes">
      <view bindtap="selectOil" data-val="{{item.value}}" wx:key="index" class="{{currentOil == item.value ? 'active' : ''}}" wx:for="{{oilList}}">{{item.label}}</view>
    </view>
  </view>
</view>

<!-- 品牌的弹框 -->
<view class="oilCard brandCard" animation="{{brandAnimation}}">
  
  <image bindtap="closeBrand" src="../../../images/dark/closeList.png" />
  <view class="cardContent">
    <text class="oilTitle">请选择品牌</text>
    <view class="oiltypes">
      <view bindtap="selectBrand" data-val="{{item.value}}" wx:key="index" class="{{currentBrand == item.value ? 'active' : ''}}" wx:for="{{brandList}}">{{item.label}}</view>
    </view>
  </view>
</view>


<view class="mask" wx:if="{{showMaskOil}}" bindtap="closeOil"></view>
<view class="mask" wx:if="{{showMaskBrand}}" bindtap="closeBrand"></view>